{"files":[{"id":"04fafcfe-b22a-45c1-aed2-f62434b9151d","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Tokyo\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"a36808c4-c039-4260-928f-09e8f49c9f49","name":"コード","type":"server_js","source":"function notifyWakeUpTime() {\n  // 翌日の日付を取得\n  var tomorrow \u003d new Date();\n  tomorrow.setDate(tomorrow.getDate() + 1);\n  \n  // カレンダーから翌日の予定を取得\n  var events \u003d CalendarApp.getDefaultCalendar().getEventsForDay(tomorrow);\n  \n  var earliestWakeUpTime \u003d null;\n  \n  // 予定をループして起床時刻を抽出\n  for (var i \u003d 0; i \u003c events.length; i++) {\n    var title \u003d events[i].getTitle();\n    var match \u003d title.match(/\\[(.*?)\\]/);\n    if (match) {\n      var wakeUpTime \u003d match[1];\n      if (!earliestWakeUpTime || wakeUpTime \u003c earliestWakeUpTime) {\n        earliestWakeUpTime \u003d wakeUpTime;\n      }\n    }\n  }\n  \n  // Slackにメッセージを送信\n  if (earliestWakeUpTime) {\n    sendSlackMessage(\"明日の起床時刻: \" + earliestWakeUpTime);\n  } else {\n    sendSlackMessage(\"明日の起床時刻は設定されていません。\");\n  }\n}\n\nfunction sendSlackMessage(message) {\n  // SlackのWebhook URLを設定\n  var webhookUrl \u003d \"https://hooks.slack.com/services/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\";\n  \n  var payload \u003d {\n    \"text\": message\n  };\n  \n  var options \u003d {\n    \"method\": \"post\",\n    \"contentType\": \"application/json\",\n    \"payload\": JSON.stringify(payload)\n  };\n  \n  UrlFetchApp.fetch(webhookUrl, options);\n}"}]}